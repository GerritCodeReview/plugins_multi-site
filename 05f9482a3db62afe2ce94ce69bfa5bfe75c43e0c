{
  "comments": [
    {
      "unresolved": true,
      "key": {
        "uuid": "7beacccf_32a2fe57",
        "filename": "src/main/java/com/googlesource/gerrit/plugins/multisite/GitModule.java",
        "patchSetId": 1
      },
      "lineNbr": 33,
      "author": {
        "id": 1072905
      },
      "writtenOn": "2022-01-07T15:01:39Z",
      "side": 1,
      "message": "The binding of the Log4jProjectVersionLogger has been moved here from the ValidationModule() and that makes sense.\n\nHowever the SharedRefDbConfiguration is still been left the ValidationModule() [1], is that wanted?\n\nAlso,looking at the related issue it seems that the plugin would fail to start because when `refs-database.enabled` is set to false, these bindings never happen (since the ValidationModule() is not installed).\n\nWouldn\u0027t be enough just to move the relevant binding outside the ValidationModule?\nWhat\u0027s the point of creating an interface for ProjectVersionRefUpdate?\n\n[1]https://gerrit.googlesource.com/plugins/multi-site/+/refs/changes/77/327377/1/src/main/java/com/googlesource/gerrit/plugins/multisite/validation/ValidationModule.java#66",
      "range": {
        "startLine": 32,
        "startChar": 0,
        "endLine": 33,
        "endChar": 73
      },
      "revId": "05f9482a3db62afe2ce94ce69bfa5bfe75c43e0c",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "1bff5cf8_fba0e6ba",
        "filename": "src/main/java/com/googlesource/gerrit/plugins/multisite/GitModule.java",
        "patchSetId": 1
      },
      "lineNbr": 33,
      "author": {
        "id": 1083454
      },
      "writtenOn": "2022-01-11T08:51:41Z",
      "side": 1,
      "message": "\u003e However the SharedRefDbConfiguration is still been left the ValidationModule() [1], is that wanted?\n\nGood catch it should not be there\n\n\u003e Wouldn\u0027t be enough just to move the relevant binding outside the ValidationModule?\n\u003e What\u0027s the point of creating an interface for ProjectVersionRefUpdate?\n\nProjectVersionRefUpdate is using SharedRefDatabaseWrapper and I thought the same I will just move in to ValidationModule and done. Unfortunately ReplicationStatus is using ProjectVersionRefUpdate so ProjectVersionRefUpdate must be always provided.",
      "parentUuid": "7beacccf_32a2fe57",
      "range": {
        "startLine": 32,
        "startChar": 0,
        "endLine": 33,
        "endChar": 73
      },
      "revId": "05f9482a3db62afe2ce94ce69bfa5bfe75c43e0c",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "96277855_d6a7d40a",
        "filename": "src/main/java/com/googlesource/gerrit/plugins/multisite/event/EventModule.java",
        "patchSetId": 1
      },
      "lineNbr": 40,
      "author": {
        "id": 1054778
      },
      "writtenOn": "2022-01-10T20:53:34Z",
      "side": 1,
      "message": "Is there any case where the shared-refdb section is not defined? If so we might have a NPE here.",
      "range": {
        "startLine": 40,
        "startChar": 45,
        "endLine": 40,
        "endChar": 59
      },
      "revId": "05f9482a3db62afe2ce94ce69bfa5bfe75c43e0c",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "84119696_af96c6f1",
        "filename": "src/main/java/com/googlesource/gerrit/plugins/multisite/event/EventModule.java",
        "patchSetId": 1
      },
      "lineNbr": 40,
      "author": {
        "id": 1006192
      },
      "writtenOn": "2022-01-12T09:53:13Z",
      "side": 1,
      "message": "Good point: we should check it before L40 and throw a more specific exception rather than NPE in that case.",
      "parentUuid": "96277855_d6a7d40a",
      "range": {
        "startLine": 40,
        "startChar": 45,
        "endLine": 40,
        "endChar": 59
      },
      "revId": "05f9482a3db62afe2ce94ce69bfa5bfe75c43e0c",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "afdd517d_dcb37602",
        "filename": "src/main/java/com/googlesource/gerrit/plugins/multisite/event/EventModule.java",
        "patchSetId": 1
      },
      "lineNbr": 48,
      "author": {
        "id": 1072905
      },
      "writtenOn": "2022-01-07T15:01:39Z",
      "side": 1,
      "message": "Why do we need the NoOp at all?\nCould we not always bind ProjectVersionRefUpdateImpl and only bind the eventListener when the sharedRefDb is enabled?\n\nIf the eventListener is disabled the ProjectVersionRefUpdate will never be triggered anyway right?",
      "range": {
        "startLine": 46,
        "startChar": 0,
        "endLine": 48,
        "endChar": 32
      },
      "revId": "05f9482a3db62afe2ce94ce69bfa5bfe75c43e0c",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "44bc37cb_d8d39737",
        "filename": "src/main/java/com/googlesource/gerrit/plugins/multisite/event/EventModule.java",
        "patchSetId": 1
      },
      "lineNbr": 48,
      "author": {
        "id": 1054778
      },
      "writtenOn": "2022-01-10T20:53:34Z",
      "side": 1,
      "message": "+1",
      "parentUuid": "afdd517d_dcb37602",
      "range": {
        "startLine": 46,
        "startChar": 0,
        "endLine": 48,
        "endChar": 32
      },
      "revId": "05f9482a3db62afe2ce94ce69bfa5bfe75c43e0c",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "a8960853_c1089ba7",
        "filename": "src/main/java/com/googlesource/gerrit/plugins/multisite/event/EventModule.java",
        "patchSetId": 1
      },
      "lineNbr": 48,
      "author": {
        "id": 1083454
      },
      "writtenOn": "2022-01-11T08:51:41Z",
      "side": 1,
      "message": "That was my initial idea as well, to move all the binding related to the globa-refdb to ValidationModule and use it only when ref-db is enabled(that\u0027s how it was done before the regression). Unfortunately it\u0027s not that easy because   ProjectVersionRefUpdate is injected to the ReplicationStatus and ReplicationStatus is used in many places. That\u0027s why if I cannot skip bindings I decided to introduce NoOp implementation",
      "parentUuid": "44bc37cb_d8d39737",
      "range": {
        "startLine": 46,
        "startChar": 0,
        "endLine": 48,
        "endChar": 32
      },
      "revId": "05f9482a3db62afe2ce94ce69bfa5bfe75c43e0c",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "ae5d67f1_b30f580c",
        "filename": "src/main/java/com/googlesource/gerrit/plugins/multisite/event/EventModule.java",
        "patchSetId": 1
      },
      "lineNbr": 48,
      "author": {
        "id": 1006192
      },
      "writtenOn": "2022-01-12T09:53:13Z",
      "side": 1,
      "message": "Have you tried an optional binding instead?",
      "parentUuid": "a8960853_c1089ba7",
      "range": {
        "startLine": 46,
        "startChar": 0,
        "endLine": 48,
        "endChar": 32
      },
      "revId": "05f9482a3db62afe2ce94ce69bfa5bfe75c43e0c",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "38ccb232_c62b2245",
        "filename": "src/main/java/com/googlesource/gerrit/plugins/multisite/validation/ProjectVersionRefUpdate.java",
        "patchSetId": 1
      },
      "lineNbr": 1,
      "author": {
        "id": 1072905
      },
      "writtenOn": "2022-01-07T15:01:39Z",
      "side": 1,
      "message": "2022",
      "range": {
        "startLine": 1,
        "startChar": 17,
        "endLine": 1,
        "endChar": 21
      },
      "revId": "05f9482a3db62afe2ce94ce69bfa5bfe75c43e0c",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "28a9b2e7_38341a11",
        "filename": "src/main/java/com/googlesource/gerrit/plugins/multisite/validation/ProjectVersionRefUpdate.java",
        "patchSetId": 1
      },
      "lineNbr": 1,
      "author": {
        "id": 1083454
      },
      "writtenOn": "2022-01-11T08:51:41Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "38ccb232_c62b2245",
      "range": {
        "startLine": 1,
        "startChar": 17,
        "endLine": 1,
        "endChar": 21
      },
      "revId": "05f9482a3db62afe2ce94ce69bfa5bfe75c43e0c",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "b85632b6_c48fef12",
        "filename": "src/main/java/com/googlesource/gerrit/plugins/multisite/validation/ProjectVersionRefUpdateImpl.java",
        "patchSetId": 1
      },
      "lineNbr": 1,
      "author": {
        "id": 1054778
      },
      "writtenOn": "2022-01-10T20:53:34Z",
      "side": 1,
      "message": "2022",
      "range": {
        "startLine": 1,
        "startChar": 17,
        "endLine": 1,
        "endChar": 21
      },
      "revId": "05f9482a3db62afe2ce94ce69bfa5bfe75c43e0c",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "5feda282_74f58cff",
        "filename": "src/main/java/com/googlesource/gerrit/plugins/multisite/validation/ProjectVersionRefUpdateImpl.java",
        "patchSetId": 1
      },
      "lineNbr": 1,
      "author": {
        "id": 1083454
      },
      "writtenOn": "2022-01-11T08:51:41Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "b85632b6_c48fef12",
      "range": {
        "startLine": 1,
        "startChar": 17,
        "endLine": 1,
        "endChar": 21
      },
      "revId": "05f9482a3db62afe2ce94ce69bfa5bfe75c43e0c",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "dd5e7cb1_3b26eb30",
        "filename": "src/main/java/com/googlesource/gerrit/plugins/multisite/validation/ProjectVersionRefUpdateNoOp.java",
        "patchSetId": 1
      },
      "lineNbr": 1,
      "author": {
        "id": 1072905
      },
      "writtenOn": "2022-01-07T15:01:39Z",
      "side": 1,
      "message": "2022",
      "range": {
        "startLine": 1,
        "startChar": 17,
        "endLine": 1,
        "endChar": 21
      },
      "revId": "05f9482a3db62afe2ce94ce69bfa5bfe75c43e0c",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "05311cdd_924fc195",
        "filename": "src/main/java/com/googlesource/gerrit/plugins/multisite/validation/ProjectVersionRefUpdateNoOp.java",
        "patchSetId": 1
      },
      "lineNbr": 1,
      "author": {
        "id": 1083454
      },
      "writtenOn": "2022-01-11T08:51:41Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "dd5e7cb1_3b26eb30",
      "range": {
        "startLine": 1,
        "startChar": 17,
        "endLine": 1,
        "endChar": 21
      },
      "revId": "05f9482a3db62afe2ce94ce69bfa5bfe75c43e0c",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "33b07632_1d6ed074",
        "filename": "src/main/java/com/googlesource/gerrit/plugins/multisite/validation/ValidationModule.java",
        "patchSetId": 1
      },
      "lineNbr": 56,
      "author": {
        "id": 1072905
      },
      "writtenOn": "2022-01-07T15:01:39Z",
      "side": 1,
      "message": "nit: remove empty line",
      "revId": "05f9482a3db62afe2ce94ce69bfa5bfe75c43e0c",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "06a726cc_ce15de96",
        "filename": "src/main/java/com/googlesource/gerrit/plugins/multisite/validation/ValidationModule.java",
        "patchSetId": 1
      },
      "lineNbr": 56,
      "author": {
        "id": 1083454
      },
      "writtenOn": "2022-01-11T08:51:41Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "33b07632_1d6ed074",
      "revId": "05f9482a3db62afe2ce94ce69bfa5bfe75c43e0c",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "289d5588_2b3602a3",
        "filename": "src/test/java/com/googlesource/gerrit/plugins/multisite/http/ReplicationStatusServletIT.java",
        "patchSetId": 1
      },
      "lineNbr": 68,
      "author": {
        "id": 1072905
      },
      "writtenOn": "2022-01-07T15:01:39Z",
      "side": 1,
      "message": "nit: remove empty line",
      "revId": "05f9482a3db62afe2ce94ce69bfa5bfe75c43e0c",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "9c25e6c8_1962b6d8",
        "filename": "src/test/java/com/googlesource/gerrit/plugins/multisite/http/ReplicationStatusServletIT.java",
        "patchSetId": 1
      },
      "lineNbr": 68,
      "author": {
        "id": 1083454
      },
      "writtenOn": "2022-01-11T08:51:41Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "289d5588_2b3602a3",
      "revId": "05f9482a3db62afe2ce94ce69bfa5bfe75c43e0c",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "ecde435c_21a8867e",
        "filename": "src/test/java/com/googlesource/gerrit/plugins/multisite/validation/ProjectVersionRefUpdateTest.java",
        "patchSetId": 1
      },
      "lineNbr": 113,
      "author": {
        "id": 1072905
      },
      "writtenOn": "2022-01-07T15:01:39Z",
      "side": 1,
      "message": "In addition to this change, shouldn\u0027t we have a test that explicitly checks that the binding is satisfied when global-refdb is disabled?",
      "range": {
        "startLine": 113,
        "startChar": 4,
        "endLine": 113,
        "endChar": 36
      },
      "revId": "05f9482a3db62afe2ce94ce69bfa5bfe75c43e0c",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "3fe1d9a3_94e2fa4a",
        "filename": "src/test/java/com/googlesource/gerrit/plugins/multisite/validation/ProjectVersionRefUpdateTest.java",
        "patchSetId": 1
      },
      "lineNbr": 113,
      "author": {
        "id": 1083454
      },
      "writtenOn": "2022-01-11T08:51:41Z",
      "side": 1,
      "message": "Good point I will add the test",
      "parentUuid": "ecde435c_21a8867e",
      "range": {
        "startLine": 113,
        "startChar": 4,
        "endLine": 113,
        "endChar": 36
      },
      "revId": "05f9482a3db62afe2ce94ce69bfa5bfe75c43e0c",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "4b44d510_68690a06",
        "filename": "src/test/java/com/googlesource/gerrit/plugins/multisite/validation/ProjectVersionRefUpdateTest.java",
        "patchSetId": 1
      },
      "lineNbr": 113,
      "author": {
        "id": 1072905
      },
      "writtenOn": "2022-01-12T08:29:16Z",
      "side": 1,
      "message": "@marcin, is this ready for review again?\nI can\u0027t see the added test",
      "parentUuid": "3fe1d9a3_94e2fa4a",
      "range": {
        "startLine": 113,
        "startChar": 4,
        "endLine": 113,
        "endChar": 36
      },
      "revId": "05f9482a3db62afe2ce94ce69bfa5bfe75c43e0c",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "0141fb44_02b79a8c",
        "filename": "src/test/java/com/googlesource/gerrit/plugins/multisite/validation/ProjectVersionRefUpdateTest.java",
        "patchSetId": 1
      },
      "lineNbr": 113,
      "author": {
        "id": 1083454
      },
      "writtenOn": "2022-01-12T09:15:30Z",
      "side": 1,
      "message": "Not yet I\u0027m still working on the test",
      "parentUuid": "4b44d510_68690a06",
      "range": {
        "startLine": 113,
        "startChar": 4,
        "endLine": 113,
        "endChar": 36
      },
      "revId": "05f9482a3db62afe2ce94ce69bfa5bfe75c43e0c",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    }
  ]
}