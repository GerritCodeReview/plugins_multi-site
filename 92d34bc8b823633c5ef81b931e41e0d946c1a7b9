{
  "comments": [
    {
      "unresolved": true,
      "key": {
        "uuid": "6a07474a_856239f3",
        "filename": "/COMMIT_MSG",
        "patchSetId": 2
      },
      "lineNbr": 33,
      "author": {
        "id": 1157810
      },
      "writtenOn": "2023-12-14T10:14:42Z",
      "side": 1,
      "message": "can you please create an issue and link it here.",
      "revId": "92d34bc8b823633c5ef81b931e41e0d946c1a7b9",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "aa2337ee_63878173",
        "filename": "/COMMIT_MSG",
        "patchSetId": 2
      },
      "lineNbr": 33,
      "author": {
        "id": 1006192
      },
      "writtenOn": "2023-12-14T20:50:52Z",
      "side": 1,
      "message": "This isn\u0027t an issue but an optimisation.",
      "parentUuid": "6a07474a_856239f3",
      "revId": "92d34bc8b823633c5ef81b931e41e0d946c1a7b9",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "91794d3b_42b6ab9f",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 2
      },
      "lineNbr": 0,
      "author": {
        "id": 1157810
      },
      "writtenOn": "2023-12-14T10:13:17Z",
      "side": 1,
      "message": "Besides this not compiling, a test is missing, and I have questions on the implementation.",
      "revId": "92d34bc8b823633c5ef81b931e41e0d946c1a7b9",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "497bd37b_848f244b",
        "filename": "src/main/java/com/googlesource/gerrit/plugins/multisite/validation/ProjectVersionRefUpdateImpl.java",
        "patchSetId": 2
      },
      "lineNbr": 90,
      "author": {
        "id": 1157810
      },
      "writtenOn": "2023-12-14T10:13:17Z",
      "side": 1,
      "message": "If the batch contains multiple refs, and one of those is a \"special\" ref, we discard the entire batch. Is this really what we want here? I\u0027d imagine we\u0027d want to filter out the \"special\" refs, and carry on with the update. Even more worryingly, there\u0027s not a test that asserts (and also documents) on this behaviour, as far as I can see.",
      "revId": "92d34bc8b823633c5ef81b931e41e0d946c1a7b9",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "3bce8204_76736920",
        "filename": "src/main/java/com/googlesource/gerrit/plugins/multisite/validation/ProjectVersionRefUpdateImpl.java",
        "patchSetId": 2
      },
      "lineNbr": 90,
      "author": {
        "id": 1006192
      },
      "writtenOn": "2023-12-14T20:50:52Z",
      "side": 1,
      "message": "Good catch !\n\nHonestly we should not even have this check for special ref and it does not make sense anymore.\n\nIt was possibly in the past when were not replicating starred changes and sequences, but nowadays we should still update the global-refdb version when we change them. I would prefer to address that concern as a separate change.",
      "parentUuid": "497bd37b_848f244b",
      "revId": "92d34bc8b823633c5ef81b931e41e0d946c1a7b9",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "5174402f_e17e53aa",
        "filename": "src/main/java/com/googlesource/gerrit/plugins/multisite/validation/ProjectVersionRefUpdateImpl.java",
        "patchSetId": 2
      },
      "lineNbr": 108,
      "author": {
        "id": 1155599
      },
      "writtenOn": "2023-12-13T23:53:34Z",
      "side": 1,
      "message": "```suggestion\n            \"Ref %s not found on project %s: skipping project version update\",\n```",
      "range": {
        "startLine": 108,
        "startChar": 13,
        "endLine": 108,
        "endChar": 16
      },
      "revId": "92d34bc8b823633c5ef81b931e41e0d946c1a7b9",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "c95cf89d_a9679f16",
        "filename": "src/main/java/com/googlesource/gerrit/plugins/multisite/validation/ProjectVersionRefUpdateImpl.java",
        "patchSetId": 2
      },
      "lineNbr": 108,
      "author": {
        "id": 1072905
      },
      "writtenOn": "2023-12-15T10:01:17Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "5174402f_e17e53aa",
      "range": {
        "startLine": 108,
        "startChar": 13,
        "endLine": 108,
        "endChar": 16
      },
      "revId": "92d34bc8b823633c5ef81b931e41e0d946c1a7b9",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "13b9e17c_45e52c7a",
        "filename": "src/main/java/com/googlesource/gerrit/plugins/multisite/validation/ProjectVersionRefUpdateImpl.java",
        "patchSetId": 2
      },
      "lineNbr": 109,
      "author": {
        "id": 1155599
      },
      "writtenOn": "2023-12-13T23:53:34Z",
      "side": 1,
      "message": "I assume this will always be `refs/multi-site/version`?",
      "range": {
        "startLine": 109,
        "startChar": 28,
        "endLine": 109,
        "endChar": 44
      },
      "revId": "92d34bc8b823633c5ef81b931e41e0d946c1a7b9",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "aa0310d6_3793ed2c",
        "filename": "src/main/java/com/googlesource/gerrit/plugins/multisite/validation/ProjectVersionRefUpdateImpl.java",
        "patchSetId": 2
      },
      "lineNbr": 109,
      "author": {
        "id": 1006192
      },
      "writtenOn": "2023-12-14T20:50:52Z",
      "side": 1,
      "message": "Good point, but before it was taking the ref-name from the `refUpdatedEvent` which is wrong.\n\nLast but not least, the `newProjectVersionRefUpdate` is never returned as empty in the code, so this else is effectively unreachable.\n\nI will address as a separate change.",
      "parentUuid": "13b9e17c_45e52c7a",
      "range": {
        "startLine": 109,
        "startChar": 28,
        "endLine": 109,
        "endChar": 44
      },
      "revId": "92d34bc8b823633c5ef81b931e41e0d946c1a7b9",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "0faad3cd_050e87fa",
        "filename": "src/main/java/com/googlesource/gerrit/plugins/multisite/validation/ProjectVersionRefUpdateImpl.java",
        "patchSetId": 2
      },
      "lineNbr": 109,
      "author": {
        "id": 1072905
      },
      "writtenOn": "2023-12-15T10:01:17Z",
      "side": 1,
      "message": "@luca.milanesio@gmail.com can you make sure this is captured somewhere so we don\u0027t forget? I am happy to create an issue if you haven\u0027t already",
      "parentUuid": "aa0310d6_3793ed2c",
      "range": {
        "startLine": 109,
        "startChar": 28,
        "endLine": 109,
        "endChar": 44
      },
      "revId": "92d34bc8b823633c5ef81b931e41e0d946c1a7b9",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "af9a6f0d_5e6980f9",
        "filename": "src/test/java/com/googlesource/gerrit/plugins/multisite/validation/ProjectVersionRefUpdateTest.java",
        "patchSetId": 2
      },
      "lineNbr": 63,
      "author": {
        "id": 1157810
      },
      "writtenOn": "2023-12-14T10:13:17Z",
      "side": 1,
      "message": "I don\u0027t see any test which verifies your change, ie a `GitBatchRefUpdateListener.Event` with multiple refs and a verification that the `refs/multi-site/version/value` was updated just once.",
      "revId": "92d34bc8b823633c5ef81b931e41e0d946c1a7b9",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "a5f3c743_29676165",
        "filename": "src/test/java/com/googlesource/gerrit/plugins/multisite/validation/ProjectVersionRefUpdateTest.java",
        "patchSetId": 2
      },
      "lineNbr": 63,
      "author": {
        "id": 1006192
      },
      "writtenOn": "2023-12-14T20:50:52Z",
      "side": 1,
      "message": "True, need to add one extra test-case for that.",
      "parentUuid": "af9a6f0d_5e6980f9",
      "revId": "92d34bc8b823633c5ef81b931e41e0d946c1a7b9",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    }
  ]
}