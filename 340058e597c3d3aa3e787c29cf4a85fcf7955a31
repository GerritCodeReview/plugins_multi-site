{
  "comments": [
    {
      "key": {
        "uuid": "856ce048_f2f460da",
        "filename": "src/main/java/com/googlesource/gerrit/plugins/multisite/SharedRefDatabaseWrapper.java",
        "patchSetId": 9
      },
      "lineNbr": 53,
      "author": {
        "id": 1054778
      },
      "writtenOn": "2019-07-19T17:18:04Z",
      "side": 1,
      "message": "Are we not logging because this this operation is not interacting with the SharedRefDB?",
      "range": {
        "startLine": 53,
        "startChar": 11,
        "endLine": 53,
        "endChar": 57
      },
      "revId": "340058e597c3d3aa3e787c29cf4a85fcf7955a31",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "a62d2c9c_2fc86206",
        "filename": "src/main/java/com/googlesource/gerrit/plugins/multisite/SharedRefDatabaseWrapper.java",
        "patchSetId": 9
      },
      "lineNbr": 53,
      "author": {
        "id": 1072905
      },
      "writtenOn": "2019-07-19T17:30:06Z",
      "side": 1,
      "message": "This method is not used.\nIf you look in the next change in the chain you\u0027ll see that I am actually removing this.",
      "parentUuid": "856ce048_f2f460da",
      "range": {
        "startLine": 53,
        "startChar": 11,
        "endLine": 53,
        "endChar": 57
      },
      "revId": "340058e597c3d3aa3e787c29cf4a85fcf7955a31",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "f28db1f7_750042be",
        "filename": "src/main/java/com/googlesource/gerrit/plugins/multisite/SharedRefDatabaseWrapper.java",
        "patchSetId": 9
      },
      "lineNbr": 58,
      "author": {
        "id": 1054778
      },
      "writtenOn": "2019-07-19T17:18:04Z",
      "side": 1,
      "message": "could it be useful to log the locking operations as well?",
      "range": {
        "startLine": 58,
        "startChar": 23,
        "endLine": 58,
        "endChar": 30
      },
      "revId": "340058e597c3d3aa3e787c29cf4a85fcf7955a31",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "2210e1d4_b4591c19",
        "filename": "src/main/java/com/googlesource/gerrit/plugins/multisite/SharedRefDatabaseWrapper.java",
        "patchSetId": 9
      },
      "lineNbr": 58,
      "author": {
        "id": 1072905
      },
      "writtenOn": "2019-07-19T17:30:06Z",
      "side": 1,
      "message": "Mmmm, I am not sure.\nPerhaps it would actually.\n@luca, @marcin, @tiago WDYT?",
      "parentUuid": "f28db1f7_750042be",
      "range": {
        "startLine": 58,
        "startChar": 23,
        "endLine": 58,
        "endChar": 30
      },
      "revId": "340058e597c3d3aa3e787c29cf4a85fcf7955a31",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "4ac1c6e3_a8681173",
        "filename": "src/main/java/com/googlesource/gerrit/plugins/multisite/SharedRefDatabaseWrapper.java",
        "patchSetId": 9
      },
      "lineNbr": 58,
      "author": {
        "id": 1054778
      },
      "writtenOn": "2019-07-22T17:24:41Z",
      "side": 1,
      "message": "This could be added later if needed.",
      "parentUuid": "2210e1d4_b4591c19",
      "range": {
        "startLine": 58,
        "startChar": 23,
        "endLine": 58,
        "endChar": 30
      },
      "revId": "340058e597c3d3aa3e787c29cf4a85fcf7955a31",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "ad62fb05_ddf31a5f",
        "filename": "src/main/java/com/googlesource/gerrit/plugins/multisite/SharedRefLogEntry.java",
        "patchSetId": 9
      },
      "lineNbr": 44,
      "author": {
        "id": 1054778
      },
      "writtenOn": "2019-07-19T17:18:04Z",
      "side": 1,
      "message": "Would it be useful to timestamp the operations as well?",
      "range": {
        "startLine": 38,
        "startChar": 4,
        "endLine": 44,
        "endChar": 23
      },
      "revId": "340058e597c3d3aa3e787c29cf4a85fcf7955a31",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "a6b037e6_ef8e136b",
        "filename": "src/main/java/com/googlesource/gerrit/plugins/multisite/SharedRefLogEntry.java",
        "patchSetId": 9
      },
      "lineNbr": 44,
      "author": {
        "id": 1072905
      },
      "writtenOn": "2019-07-19T17:30:06Z",
      "side": 1,
      "message": "this is already logged as part of the committer object: https://pastebin.com/m0CHgAuL\nAnd also the log entry has a commit timestamp",
      "parentUuid": "ad62fb05_ddf31a5f",
      "range": {
        "startLine": 38,
        "startChar": 4,
        "endLine": 44,
        "endChar": 23
      },
      "revId": "340058e597c3d3aa3e787c29cf4a85fcf7955a31",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "be1addf2_9c057ba1",
        "filename": "src/main/java/com/googlesource/gerrit/plugins/multisite/SharedRefLogEntry.java",
        "patchSetId": 9
      },
      "lineNbr": 44,
      "author": {
        "id": 1054778
      },
      "writtenOn": "2019-07-19T17:35:08Z",
      "side": 1,
      "message": "Do we also have the the timestamp of the reupdate operation? I think that\u0027s what we are also interested in.",
      "parentUuid": "a6b037e6_ef8e136b",
      "range": {
        "startLine": 38,
        "startChar": 4,
        "endLine": 44,
        "endChar": 23
      },
      "revId": "340058e597c3d3aa3e787c29cf4a85fcf7955a31",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "f9320550_6aff99f0",
        "filename": "src/main/java/com/googlesource/gerrit/plugins/multisite/SharedRefLogEntry.java",
        "patchSetId": 9
      },
      "lineNbr": 44,
      "author": {
        "id": 1072905
      },
      "writtenOn": "2019-07-19T17:38:30Z",
      "side": 1,
      "message": "mmm, I am not sure I follow, isn\u0027t the commit timestamp, the timestamp in which the reference was updated?\nHow do they differ?\nWanna point me to the part of the code you want to \"record\"?",
      "parentUuid": "be1addf2_9c057ba1",
      "range": {
        "startLine": 38,
        "startChar": 4,
        "endLine": 44,
        "endChar": 23
      },
      "revId": "340058e597c3d3aa3e787c29cf4a85fcf7955a31",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "e250d538_8c632dee",
        "filename": "src/main/java/com/googlesource/gerrit/plugins/multisite/SharedRefLogEntry.java",
        "patchSetId": 9
      },
      "lineNbr": 44,
      "author": {
        "id": 1072905
      },
      "writtenOn": "2019-07-19T17:44:11Z",
      "side": 1,
      "message": "Ok i understand what you mean...Yes, perhaps we need it, but that would be the same as the log entry no?",
      "parentUuid": "f9320550_6aff99f0",
      "range": {
        "startLine": 38,
        "startChar": 4,
        "endLine": 44,
        "endChar": 23
      },
      "revId": "340058e597c3d3aa3e787c29cf4a85fcf7955a31",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "98a96f83_3c25ebd3",
        "filename": "src/main/java/com/googlesource/gerrit/plugins/multisite/SharedRefLogEntry.java",
        "patchSetId": 9
      },
      "lineNbr": 44,
      "author": {
        "id": 1054778
      },
      "writtenOn": "2019-07-20T01:20:22Z",
      "side": 1,
      "message": "I don\u0027t think so. The log entry will report the time you are logging something, which is not necessarily the one the action you want to log was performed.\n\nImagine you do an \"UpdateRef\" which takes one second and then you log it. You wouldn\u0027t know at what time the UpdateRef was done.",
      "parentUuid": "e250d538_8c632dee",
      "range": {
        "startLine": 38,
        "startChar": 4,
        "endLine": 44,
        "endChar": 23
      },
      "revId": "340058e597c3d3aa3e787c29cf4a85fcf7955a31",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "8b2c6370_d679b291",
        "filename": "src/main/java/com/googlesource/gerrit/plugins/multisite/SharedRefLogEntry.java",
        "patchSetId": 9
      },
      "lineNbr": 44,
      "author": {
        "id": 1072905
      },
      "writtenOn": "2019-07-22T12:27:32Z",
      "side": 1,
      "message": "mmmh, so I have been thinking about this.\nAt the moment the refUpdate works this way:\n- The local ref is updated (RefUpdateValidator.executeRefUpdate)\n- Upon success, the sharedRef DB is locked and then updated via compareAndPut() method, to reflect that change.\n\nBy the time compareAndPut() method is called, any information on what time/how long the local ref update took is long gone.\nWe could propagate that timestamp (let\u0027s call it, say, refUpdateTime) all the way to the actual compareAndPut() method, but this would require to change the compareAndPut() interface for an information that would only be used for logging, and thus possibly not used at all, depending on the bound implementation.\n\nI would argue that this logging (sharedref_log) should solely record interactions with the sharedRef database rather than being a source of truth on related data, such as the refUpdate time/length.\n\nThe original request for this issue was to make the output similar to the refLog one[1], which is the one that is provided by this change.\nI believe this is in scope because it just _hydrates_ objectId information, rather than adding _extra_ information such as the refUpdate time.\n\nHope it makes sense :)\nWDYT?  \n\n[1] https://bugs.chromium.org/p/gerrit/issues/detail?id\u003d11166#c2",
      "parentUuid": "98a96f83_3c25ebd3",
      "range": {
        "startLine": 38,
        "startChar": 4,
        "endLine": 44,
        "endChar": 23
      },
      "revId": "340058e597c3d3aa3e787c29cf4a85fcf7955a31",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "a15dd5ca_12771509",
        "filename": "src/main/java/com/googlesource/gerrit/plugins/multisite/SharedRefLogEntry.java",
        "patchSetId": 9
      },
      "lineNbr": 44,
      "author": {
        "id": 1054778
      },
      "writtenOn": "2019-07-22T17:22:00Z",
      "side": 1,
      "message": "Yep, makes totally sense. I was missing the context of this change. Thanks",
      "parentUuid": "8b2c6370_d679b291",
      "range": {
        "startLine": 38,
        "startChar": 4,
        "endLine": 44,
        "endChar": 23
      },
      "revId": "340058e597c3d3aa3e787c29cf4a85fcf7955a31",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "74792d64_ab8d1581",
        "filename": "src/main/java/com/googlesource/gerrit/plugins/multisite/SharedRefLogEntry.java",
        "patchSetId": 9
      },
      "lineNbr": 57,
      "author": {
        "id": 1054778
      },
      "writtenOn": "2019-07-19T17:18:04Z",
      "side": 1,
      "message": "This is not needed, right ?",
      "range": {
        "startLine": 57,
        "startChar": 4,
        "endLine": 57,
        "endChar": 26
      },
      "revId": "340058e597c3d3aa3e787c29cf4a85fcf7955a31",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "a5bf7343_e0f66c57",
        "filename": "src/main/java/com/googlesource/gerrit/plugins/multisite/SharedRefLogEntry.java",
        "patchSetId": 9
      },
      "lineNbr": 57,
      "author": {
        "id": 1072905
      },
      "writtenOn": "2019-07-19T17:30:06Z",
      "side": 1,
      "message": "Ack",
      "parentUuid": "74792d64_ab8d1581",
      "range": {
        "startLine": 57,
        "startChar": 4,
        "endLine": 57,
        "endChar": 26
      },
      "revId": "340058e597c3d3aa3e787c29cf4a85fcf7955a31",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "cd640356_4844a7a3",
        "filename": "src/main/java/com/googlesource/gerrit/plugins/multisite/SharedRefLogEntry.java",
        "patchSetId": 9
      },
      "lineNbr": 58,
      "author": {
        "id": 1054778
      },
      "writtenOn": "2019-07-19T17:18:04Z",
      "side": 1,
      "message": "This is not needed, right?",
      "range": {
        "startLine": 58,
        "startChar": 4,
        "endLine": 58,
        "endChar": 24
      },
      "revId": "340058e597c3d3aa3e787c29cf4a85fcf7955a31",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "651cfe67_3ba2ad9c",
        "filename": "src/main/java/com/googlesource/gerrit/plugins/multisite/SharedRefLogEntry.java",
        "patchSetId": 9
      },
      "lineNbr": 58,
      "author": {
        "id": 1072905
      },
      "writtenOn": "2019-07-19T17:30:06Z",
      "side": 1,
      "message": "Ack",
      "parentUuid": "cd640356_4844a7a3",
      "range": {
        "startLine": 58,
        "startChar": 4,
        "endLine": 58,
        "endChar": 24
      },
      "revId": "340058e597c3d3aa3e787c29cf4a85fcf7955a31",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    }
  ]
}