{
  "comments": [
    {
      "unresolved": false,
      "key": {
        "uuid": "73323793_accc381b",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 6
      },
      "lineNbr": 0,
      "author": {
        "id": 1083454
      },
      "writtenOn": "2023-03-30T23:49:50Z",
      "side": 1,
      "message": "As a follow up change we should consider skipping ref fetch if the ref is deleted in global-refdb",
      "revId": "730df8af7ca3119e485a90fb9d2477be4eb8cabd",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "d24ab7bb_f77e5d5b",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 6
      },
      "lineNbr": 0,
      "author": {
        "id": 1083454
      },
      "writtenOn": "2023-03-31T00:25:39Z",
      "side": 1,
      "message": "Done in the follow up change",
      "parentUuid": "73323793_accc381b",
      "revId": "730df8af7ca3119e485a90fb9d2477be4eb8cabd",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "c06563b8_5ef63b58",
        "filename": "src/main/java/com/googlesource/gerrit/plugins/multisite/validation/MultisiteReplicationFetchFilter.java",
        "patchSetId": 6
      },
      "lineNbr": 68,
      "author": {
        "id": 1025452
      },
      "writtenOn": "2023-03-31T04:46:59Z",
      "side": 1,
      "message": "nit: formatting glitch, the easiest way to fix it would be to make it a single line and format again",
      "range": {
        "startLine": 66,
        "startChar": 22,
        "endLine": 68,
        "endChar": 39
      },
      "revId": "730df8af7ca3119e485a90fb9d2477be4eb8cabd",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "fc1c2146_66589be5",
        "filename": "src/main/java/com/googlesource/gerrit/plugins/multisite/validation/MultisiteReplicationFetchFilter.java",
        "patchSetId": 6
      },
      "lineNbr": 121,
      "author": {
        "id": 1025452
      },
      "writtenOn": "2023-03-31T04:46:59Z",
      "side": 1,
      "message": "nit: double negation could replaced with positive check\n\nThe method is called `existsInSharedRefDb` (it negates the result in the body) but what is more it also is negated again in line `#102` (hence double negation ðŸ˜Š)\n\nProposal:\n* call it `absentInSharedRefDb` with the following body\n```\nreturn sharedRefDb\n  .get(projectName, ref, String.class)\n  .filter(r -\u003e !ZERO_ID_NAME.equals(r))\n  .isEmpty();\n```\n* in line `#102` call it `return refDb.exactRef(ref) \u003d\u003d null \u0026\u0026 absentInSharedRefDb(Project.nameKey(projectName), ref);`\n\nWDYT?",
      "range": {
        "startLine": 118,
        "startChar": 11,
        "endLine": 121,
        "endChar": 19
      },
      "revId": "730df8af7ca3119e485a90fb9d2477be4eb8cabd",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "123c2e8d_b3ebc8dc",
        "filename": "src/main/java/com/googlesource/gerrit/plugins/multisite/validation/MultisiteReplicationFetchFilter.java",
        "patchSetId": 6
      },
      "lineNbr": 121,
      "author": {
        "id": 1025452
      },
      "writtenOn": "2023-03-31T05:01:54Z",
      "side": 1,
      "message": "`isEmpty` doesn\u0027t exist in `Java8` and `stable-3.4` is still officially compatible with it... the `java8` support was dropped in `stable-3.5`\n\nRewritten version should look like\n```\nreturn sharedRefDb\n  .get(projectName, ref, String.class)\n  .map(r -\u003e !ZERO_ID_NAME.equals(r))\n  .orElse(false);\n```",
      "range": {
        "startLine": 121,
        "startChar": 8,
        "endLine": 121,
        "endChar": 19
      },
      "revId": "730df8af7ca3119e485a90fb9d2477be4eb8cabd",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "bb591ffb_c651cbbd",
        "filename": "src/main/java/com/googlesource/gerrit/plugins/multisite/validation/MultisiteReplicationFetchFilter.java",
        "patchSetId": 6
      },
      "lineNbr": 121,
      "author": {
        "id": 1025452
      },
      "writtenOn": "2023-03-31T05:01:54Z",
      "side": 1,
      "message": "and considering the lack of `isEmpty` in `Java8` the method body would look like\n```\nreturn sharedRefDb\n  .get(projectName, ref, String.class)\n  .map(r -\u003e ZERO_ID_NAME.equals(r))\n  .orElse(true);\n```",
      "parentUuid": "fc1c2146_66589be5",
      "range": {
        "startLine": 118,
        "startChar": 11,
        "endLine": 121,
        "endChar": 19
      },
      "revId": "730df8af7ca3119e485a90fb9d2477be4eb8cabd",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    }
  ]
}