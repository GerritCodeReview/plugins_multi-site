{
  "comments": [
    {
      "key": {
        "uuid": "de80132b_bd565609",
        "filename": "src/main/java/com/googlesource/gerrit/plugins/multisite/validation/dfsrefdb/zookeeper/ZkValidationModule.java",
        "patchSetId": 11
      },
      "lineNbr": 37,
      "author": {
        "id": 1083454
      },
      "writtenOn": "2019-08-13T18:22:33Z",
      "side": 1,
      "message": "I know that it\u0027s already merge but I realise something. Shouldn\u0027t we have here DynamicItem.bind(binder(), SharedRefDatabase.class).to(ZkSharedRefDatabase.class).*in(Scopes.SINGLETON)*; if not every time in SharedRefDatabaseWrapper we do get() we are getting new instance(I had the same problem with kafka broker).",
      "range": {
        "startLine": 37,
        "startChar": 4,
        "endLine": 37,
        "endChar": 86
      },
      "revId": "1d68ce24effa4a1ab0688061eb56c24fc2e7af6e",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "037d8898_a3d83c47",
        "filename": "src/main/java/com/googlesource/gerrit/plugins/multisite/validation/dfsrefdb/zookeeper/ZkValidationModule.java",
        "patchSetId": 11
      },
      "lineNbr": 37,
      "author": {
        "id": 1072905
      },
      "writtenOn": "2019-08-13T19:28:13Z",
      "side": 1,
      "message": "\u003e if not every time in SharedRefDatabaseWrapper we do get() we are getting new instance(I had the same problem with Kafka broker).\n\nMy understanding was that the dynamicItem is a tiny wrapper around a provider. When you bind a different item, then you are just replacing that provider with another one that gives you the newly registered item.\n\nWhen you call get(), you get whatever item is registered and yes, perhaps is a new one every time, I am not sure, but I wouldn\u0027t have thought that registering the DynamicItem as a singleton would make any difference.\n\nIs this so? did you manage to test that registering DynamicItem as a singleton stops getting always new instances?",
      "parentUuid": "de80132b_bd565609",
      "range": {
        "startLine": 37,
        "startChar": 4,
        "endLine": 37,
        "endChar": 86
      },
      "revId": "1d68ce24effa4a1ab0688061eb56c24fc2e7af6e",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "33ee06e8_93b095e4",
        "filename": "src/main/java/com/googlesource/gerrit/plugins/multisite/validation/dfsrefdb/zookeeper/ZkValidationModule.java",
        "patchSetId": 11
      },
      "lineNbr": 37,
      "author": {
        "id": 1083454
      },
      "writtenOn": "2019-08-13T19:45:04Z",
      "side": 1,
      "message": "My understanding was the same but I had the problem with KafkaSession when I had it without singleton scope every time I was calling get() I was getting instance which wasn\u0027t connected, after marking it as a singleton I have to connect just once.",
      "parentUuid": "037d8898_a3d83c47",
      "range": {
        "startLine": 37,
        "startChar": 4,
        "endLine": 37,
        "endChar": 86
      },
      "revId": "1d68ce24effa4a1ab0688061eb56c24fc2e7af6e",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "bb69f967_c372bf95",
        "filename": "src/main/java/com/googlesource/gerrit/plugins/multisite/validation/dfsrefdb/zookeeper/ZkValidationModule.java",
        "patchSetId": 11
      },
      "lineNbr": 37,
      "author": {
        "id": 1006192
      },
      "writtenOn": "2019-08-13T20:12:50Z",
      "side": 1,
      "message": "Yes, Singleton is missing.",
      "parentUuid": "33ee06e8_93b095e4",
      "range": {
        "startLine": 37,
        "startChar": 4,
        "endLine": 37,
        "endChar": 86
      },
      "revId": "1d68ce24effa4a1ab0688061eb56c24fc2e7af6e",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": true
    }
  ]
}